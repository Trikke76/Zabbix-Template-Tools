Version: 1.0

# ---------------------------------------------------------------------------
# Enterprise OIDs reference:
# Official registry of all vendor enterprise numbers:
# https://www.iana.org/assignments/enterprise-numbers/
#
# Nimble Storage enterprise ID:
#   37447  =>  .1.3.6.1.4.1.37447
#
# Use this OID in lld.include_roots to walk Nimble's vendor subtree.
# ---------------------------------------------------------------------------

# ---------------------------------------------------------------------------
# MIB-2 scalar filter:
#   - generic, useful metrics for any SNMP device
#   - system identity, CPU/memory, uptime, basic interface info
# ---------------------------------------------------------------------------
mib2:
  regex: >
    (
      # ---------- System Identification ----------
      sysDescr|sysObjectID|sysName|sysLocation|sysContact|
      contact|description|location|name|objectid|
      vendor|manufacturer|model|hardware|system|

      # ---------- CPU / Memory / Uptime ----------
      cpu|processor|
      mem|memory|hrMemorySize|
      sysUpTime|

      # ---------- Host Resources ----------
      hrProcessorLoad|
      hrStorageUsed|hrStorageSize|hrStorageDescr|

      # ---------- Interfaces (selected scalars only) ----------
      ifNumber|
      ifAdminStatus|ifOperStatus|
      ifSpeed|ifHighSpeed
    )

# ---------------------------------------------------------------------------
# Vendor scalar filter (Nimble / generic storage):
#   - broader match for enterprise/vendor trees (.1.3.6.1.4.1.*)
#   - resource usage, hardware state, temperatures, fans, power, disks, etc.
# ---------------------------------------------------------------------------
vendor:
  regex: >
    (
      # Hardware / platform
      model|system|hardware|
      chassis|board|

      # CPU / load
      cpu|processor|load|usage|util|

      # Memory
      mem|memory|ram|swap|cache|

      # Storage
      disk|hdd|ssd|raid|array|lun|volume|pool|storage|

      # Power / PSU
      psu|ps|power|watt|volt|voltage|current|amps|

      # Networking
      net|nic|link|throughput|bandwidth|speed|

      # Environmental
      temp|temperature|thermal|
      fan|rpm|
      humidity|

      # Health / status
      error|errors|fail|failed|fault|
      status|state|health|ok|
      alarm|alert|warning|critical|

      # UPS / battery (if present on platform)
      ups|battery|runtime|charge
    )

# ---------------------------------------------------------------------------
# LLD table filter:
#   - which tables are interesting enough to become LLD
#   - works on standard MIB-2 ifTable/ifXTable and Nimble/vendor tables
# ---------------------------------------------------------------------------
lld:
  regex: >
    (
      # Interface traffic + errors
      ifHCInOctets|ifHCOutOctets|
      ifInOctets|ifOutOctets|
      ifInDiscards|ifOutDiscards|
      ifInErrors|ifOutErrors|
      ifHighSpeed|ifSpeed|
      ifOperStatus|ifAdminStatus|
      ifType|

      # Storage-related tables (volumes, pools, disks)
      hrStorageUsed|hrStorageSize|hrStorageDescr|
      volume|volTable|pool|lun|disk|

      # Environmental / sensors
      temperature|temp|
      voltage|volt|
      fan|rpm|
      Status
    )

  # -------------------------------------------------------------------------
  # Tables we ALWAYS want to consider for LLD (if present)
  # -------------------------------------------------------------------------
  include_roots:
    # Standard MIB-2 interfaces
    - ".1.3.6.1.2.1.2.2"        # ifTable
    - ".1.3.6.1.2.1.31.1.1"     # ifXTable

    # Nimble Storage vendor subtree
    - ".1.3.6.1.4.1.37447"                  # Nimble Storage enterprise root

  # -------------------------------------------------------------------------
  # Tables we ALMOST NEVER want as LLD on ANY device:
  #   - routing tables
  #   - ARP
  #   - TCP connection tables
  #   - HR-MIB device / process directories
  #   - Net-SNMP cache tables
  # -------------------------------------------------------------------------
  exclude_roots:
    # --- IP / routing / ARP ---
    - ".1.3.6.1.2.1.4.21"           # ipRouteTable
    - ".1.3.6.1.2.1.4.24"           # ipCidrRouteTable
    - ".1.3.6.1.2.1.4.22"           # ipNetToMediaTable (ARP)

    # --- TCP connection table (massive, rarely useful in LLD) ---
    - ".1.3.6.1.2.1.6.13"           # tcpConnTable

    # --- Host Resources junk/directory tables ---
    - ".1.3.6.1.2.1.25.3.2.1"       # hrDeviceTable (index directory)
    - ".1.3.6.1.2.1.25.4.2.1"       # hrSWRunTable (process list)
    - ".1.3.6.1.2.1.25.5.1.1"       # hrSWRunPerfTable (per-process perf)

    # --- Net-SNMP cache tables (no useful metrics) ---
    - ".1.3.6.1.4.1.8072.1.5.3"     # nsCache* (NET-SNMP-AGENT-MIB)

    # -----------------------------------------------------------------------
    # Nimble-specific junk examples:
    # If you discover any 'directory-like' tables that are not useful for
    # monitoring, you can add them here later, e.g.:
    #
    # - ".1.3.6.1.4.1.37447.1.x.y.z"
    #
    # -----------------------------------------------------------------------
