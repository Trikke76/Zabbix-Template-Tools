Version: 1.3

# ---------------------------------------------------------------------------
# Enterprise OIDs reference:
# Official registry of all vendor enterprise numbers:
# https://www.iana.org/assignments/enterprise-numbers/
#
# Use this to determine which vendor subtree(s) to include in:
#   lld.include_roots:
#     - ".1.3.6.1.4.1.<enterprise>"
#
# Examples:
#   QNAP      → 24681, 55062
#   Synology  → 6574
#   APC       → 318
#   Cisco     → 9
#   Mikrotik  → 14988
#   HP        → 11
#   Eaton     → 534
# ---------------------------------------------------------------------------


# ---------------------------------------------------------------------------
# MIB-2 scalar filter:
#   - generic, useful metrics for any SNMP device
#   - system identity, CPU/memory, uptime, basic interface info
# ---------------------------------------------------------------------------
mib2:
  regex: >
    (
      # ---------- System Identification ----------
      sysDescr|sysObjectID|sysName|sysLocation|sysContact|
      contact|description|location|name|objectid|
      vendor|manufacturer|model|hardware|system|

      # ---------- CPU / Memory / Uptime ----------
      cpu|processor|
      mem|memory|hrMemorySize|
      sysUpTime|

      # ---------- Host Resources ----------
      hrProcessorLoad|
      hrStorageUsed|hrStorageSize|hrStorageDescr|

      # ---------- Interfaces (selected scalars only) ----------
      ifNumber|
      ifAdminStatus|ifOperStatus|
      ifSpeed|ifHighSpeed
    )

# ---------------------------------------------------------------------------
# Vendor scalar filter:
#   - broader match for enterprise/vendor trees (.1.3.6.1.4.1.*)
#   - resource usage, hardware state, temperatures, fans, power, disks, etc.
# ---------------------------------------------------------------------------
vendor:
  regex: >
    (
      # Hardware / platform
      model|system|hardware|
      chassis|board|

      # CPU / load
      cpu|processor|load|usage|util|

      # Memory
      mem|memory|ram|swap|

      # Storage
      disk|hdd|ssd|raid|array|lun|volume|pool|storage|

      # Power / PSU
      psu|ps|power|watt|volt|voltage|current|amps|

      # Networking
      net|nic|link|throughput|bandwidth|speed|

      # Environmental
      temp|temperature|thermal|
      fan|rpm|
      humidity|

      # Health / status
      error|errors|fail|failed|fault|
      status|state|health|ok|
      alarm|alert|warning|critical|

      # UPS / battery
      ups|battery|runtime|charge|

      # Printers (optional but harmless)
      toner|ink|drum|tray|paper|jam
    )

# ---------------------------------------------------------------------------
# LLD table filter:
#   - which tables are interesting enough to become LLD
#   - works on standard MIB-2 ifTable/ifXTable and generic vendor tables
# ---------------------------------------------------------------------------
lld:
  # New: exact MIB names – must match *label* exactly
  exact_names:
    # Interface traffic counters (MIB-2/ifXTable)
    - ifHCInOctets
    - ifHCOutOctets
    - ifInOctets
    - ifOutOctets
    - ifInDiscards
    - ifOutDiscards
    - ifInErrors
    - ifOutErrors
    # Interface status / speed (ook standaard MIB-2)
    - ifHighSpeed
    - ifSpeed
    - ifOperStatus
    - ifAdminStatus
    - ifType
    # Host Resources storage tabel
    - hrStorageUsed
    - hrStorageSize
    - hrStorageDescr

# Existing: fuzzy / regex-based matching
  regex: >
    (
      # VLAN / bridge (LLD only, niet als scalar)
      \bdot1qVlan\w*|
      \bdot1dTpFdbPort\b|

      # Storage-gerelateerde tabellen (vendor/generic)
      \b(volume|pool|lun|raid|array|disk|hdd|ssd)\b|

      # Environmental / sensors
      \b(temp|temperature|thermal)\b|
      \b(fan|fanSpeed|fanRpm|rpm)\b|
      \b(humidity|humid)\b|
      \b(voltage|volt|vdc|vac)\b|
      \b(current|amps?|ampere)\b|

      # UPS / battery (generiek)
      \b(ups|battery|battPacks?|runtime|charge|capacity)\b
    )

  # -------------------------------------------------------------------------
  # Tables we ALWAYS want to consider for LLD (if present)
  # -------------------------------------------------------------------------
  include_roots:
    # Standard MIB-2 interfaces
    - ".1.3.6.1.2.1.2.2"        # ifTable
    - ".1.3.6.1.2.1.31.1.1"     # ifXTable

  # -------------------------------------------------------------------------
  # Tables we ALMOST NEVER want as LLD on ANY device:
  #   - routing tables
  #   - ARP
  #   - TCP connection tables
  #   - HR-MIB device / process directories
  #   - Net-SNMP cache tables
  #
  # These are global, device-agnostic junk tables for monitoring purposes.
  # -------------------------------------------------------------------------
  exclude_roots:
    # --- IP / routing / ARP ---
    - ".1.3.6.1.2.1.4.21"           # ipRouteTable
    - ".1.3.6.1.2.1.4.24"           # ipCidrRouteTable
    - ".1.3.6.1.2.1.4.22"           # ipNetToMediaTable (ARP)
    - ".1.3.6.1.2.1.25.3.7.1.1"     # hrPartitionIndex table
    - ".1.3.6.1.2.1.25.3.8.1"       # hrFSIndex table

    # --- TCP connection table (massive, rarely useful in LLD) ---
    - ".1.3.6.1.2.1.6.13"           # tcpConnTable

    # --- Host Resources junk/directory tables ---
    - ".1.3.6.1.2.1.25.3.2.1"       # hrDeviceTable (index directory)
    - ".1.3.6.1.2.1.25.4.2.1"       # hrSWRunTable (process list)
    - ".1.3.6.1.2.1.25.5.1.1"       # hrSWRunPerfTable (per-process perf)

    # --- Net-SNMP cache tables (no useful metrics) ---
    - ".1.3.6.1.4.1.8072.1.5.3"     # nsCache* (NET-SNMP-AGENT-MIB)

