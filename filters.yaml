Version: 1.1

# ---------------------------------------------------------------------------
# MIB-2 scalar filter:
#   - generic, useful metrics for any SNMP device
#   - system identity, CPU/memory, uptime, basic interface info
# ---------------------------------------------------------------------------
mib2:
  regex: >
    (
      # ---------- System Identification ----------
      sysDescr|sysObjectID|sysName|sysLocation|sysContact|
      contact|description|location|name|objectid|
      vendor|manufacturer|model|hardware|system|

      # ---------- CPU / Memory / Uptime ----------
      cpu|processor|
      mem|memory|hrMemorySize|
      sysUpTime|

      # ---------- Host Resources ----------
      hrProcessorLoad|
      hrStorageUsed|hrStorageSize|hrStorageDescr|

      # ---------- Interfaces (selected scalars only) ----------
      ifNumber|
      ifAdminStatus|ifOperStatus|
      ifSpeed|ifHighSpeed
    )

# ---------------------------------------------------------------------------
# Vendor scalar filter:
#   - broader match for enterprise/vendor trees (.1.3.6.1.4.1.*)
#   - resource usage, hardware state, temperatures, fans, power, disks, etc.
# ---------------------------------------------------------------------------
vendor:
  regex: >
    (
      # Hardware / platform
      model|system|hardware|
      chassis|board|

      # CPU / load
      cpu|processor|load|usage|util|

      # Memory
      mem|memory|ram|swap|

      # Storage
      disk|hdd|ssd|raid|array|lun|volume|pool|storage|

      # Power / PSU
      psu|ps|power|watt|volt|voltage|current|amps|

      # Networking
      net|nic|link|throughput|bandwidth|speed|

      # Environmental
      temp|temperature|thermal|
      fan|rpm|
      humidity|

      # Health / status
      error|errors|fail|failed|fault|
      status|state|health|ok|
      alarm|alert|warning|critical|

      # UPS / battery
      ups|battery|runtime|charge|

      # Printers (optional but harmless)
      toner|ink|drum|tray|paper|jam
    )

# ---------------------------------------------------------------------------
# LLD table filter:
#   - which tables are interesting enough to become LLD
#   - works on standard MIB-2 ifTable/ifXTable and generic vendor tables
# ---------------------------------------------------------------------------
lld:
  regex: >
    (
      # Interface traffic + errors
      ifHCInOctets|ifHCOutOctets|
      ifInOctets|ifOutOctets|
      ifInDiscards|ifOutDiscards|
      ifInErrors|ifOutErrors|
      ifHighSpeed|ifSpeed|
      ifOperStatus|ifAdminStatus|
      ifType|

      # VLAN / bridge (LLD only, not scalars)
      dot1qVlan|dot1qVlanStaticName|dot1qVlanFdbId|
      dot1dTpFdbPort|

      # Storage-related tables
      hrStorageUsed|hrStorageSize|hrStorageDescr|
      volume|pool|lun|disk|

      # Environmental / sensors
      BattPacks|Battery|
      Sensor|
      Humidity|
      temperature|temp|
      voltage|volt|
      Status
    )

  # -------------------------------------------------------------------------
  # Tables we ALWAYS want to consider for LLD (if present)
  # -------------------------------------------------------------------------
  include_roots:
    # Standard MIB-2 interfaces
    - ".1.3.6.1.2.1.2.2"        # ifTable
    - ".1.3.6.1.2.1.31.1.1"     # ifXTable

    # Example vendor subtree (QNAP); safe to keep, device may not have it
    - ".1.3.6.1.4.1.24681"      # QNAP NAS-MIB root (generic vendor include)

  # -------------------------------------------------------------------------
  # Tables we ALMOST NEVER want as LLD on ANY device:
  #   - routing tables
  #   - ARP
  #   - TCP connection tables
  #   - HR-MIB device / process directories
  #   - Net-SNMP cache tables
  #
  # These are global, device-agnostic junk tables for monitoring purposes.
  # -------------------------------------------------------------------------
  exclude_roots:
    # --- IP / routing / ARP ---
    - ".1.3.6.1.2.1.4.21"           # ipRouteTable
    - ".1.3.6.1.2.1.4.24"           # ipCidrRouteTable
    - ".1.3.6.1.2.1.4.22"           # ipNetToMediaTable (ARP)

    # --- TCP connection table (massive, rarely useful in LLD) ---
    - ".1.3.6.1.2.1.6.13"           # tcpConnTable

    # --- Host Resources junk/directory tables ---
    - ".1.3.6.1.2.1.25.3.2.1"       # hrDeviceTable (index directory)
    - ".1.3.6.1.2.1.25.4.2.1"       # hrSWRunTable (process list)
    - ".1.3.6.1.2.1.25.5.1.1"       # hrSWRunPerfTable (per-process perf)

    # --- Net-SNMP cache tables (no useful metrics) ---
    - ".1.3.6.1.4.1.8072.1.5.3"     # nsCache* (NET-SNMP-AGENT-MIB)

    # -----------------------------------------------------------------------
    # Device-specific junk examples :
    # Uncomment on devices where you know these subtrees are useless.
    # -----------------------------------------------------------------------

    # QNAP NAS-MIB: directory-like storageSystem/confSystem trees
    - ".1.3.6.1.4.1.24681.1.3.9.1"
    - ".1.3.6.1.4.1.24681.1.3.11.1"
    - ".1.3.6.1.4.1.24681.1.4.1.1.1"
    - ".1.3.6.1.4.1.24681.1.4.1.1.2"
    - ".1.3.6.1.4.1.24681.1.4.1.1.3"
    - ".1.3.6.1.4.1.24681.1.4.1.1.4"
    - ".1.3.6.1.4.1.24681.1.4.1.1.5"
    - ".1.3.6.1.4.1.24681.1.2.17.1"   # SysVolumeIndex table

    # Other vendors 
    # - ".1.3.6.1.4.1.xxx.yyy.zzz"      # vendor-specific index/cache tables

